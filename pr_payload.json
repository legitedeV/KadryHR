{
  "title": "feat: Complete Backend v2 - NestJS + TypeScript + PostgreSQL + Prisma",
  "body": "# ğŸš€ Backend v2: Complete NestJS + TypeScript + PostgreSQL + Prisma Implementation\n\n## ğŸ“‹ Overview\n\nThis PR introduces **backend-v2**, a complete rewrite of the KadryHR backend using modern technologies and best practices. The new backend is production-ready and provides a solid foundation for future web and mobile applications.\n\n## âœ¨ Key Features\n\n### Architecture\n- **Multi-tenant SaaS**: Row-based multi-tenancy with `organisationId` in all domain entities\n- **Single PostgreSQL database**: Efficient tenant isolation at the row level\n- **Clean NestJS architecture**: Modular design with clear separation of concerns\n\n### Authentication & Authorization\n- **JWT-based authentication**: Access tokens (15min) + Refresh tokens (7 days)\n- **Role-based access control**: OWNER, MANAGER, EMPLOYEE roles\n- **Secure password handling**: bcrypt hashing with 10 rounds\n- **Token rotation**: Refresh tokens are rotated and hashed in database\n\n### Core Domain Modules\n1. **Organisations**: Tenant management\n2. **Users**: User accounts with roles and authentication\n3. **Employees**: Employee records within organisations\n4. **Locations**: Workplace locations\n5. **Shifts**: Shift scheduling with datetime ranges\n6. **Availability**: Employee availability (date-based or weekday-based)\n\n### Technical Stack\n- **Framework**: NestJS 11\n- **Language**: TypeScript 5\n- **Database**: PostgreSQL\n- **ORM**: Prisma 7\n- **Validation**: class-validator, class-transformer\n- **Testing**: Jest\n- **Code Quality**: ESLint, Prettier\n\n## ğŸ”§ What's Included\n\n### Source Code\n- âœ… Complete NestJS application structure\n- âœ… Prisma schema with all domain models\n- âœ… Database migrations\n- âœ… Seed script for development data\n- âœ… DTOs with validation decorators\n- âœ… Guards and decorators for authorization\n- âœ… Error handling and filters\n- âœ… Unit tests (3 test suites, 6 tests - all passing)\n\n### Configuration\n- âœ… Environment variable validation\n- âœ… TypeScript configuration\n- âœ… ESLint and Prettier setup\n- âœ… Jest configuration\n- âœ… Prisma configuration\n\n### Documentation\n- âœ… Comprehensive README.md\n- âœ… Setup instructions\n- âœ… API documentation\n- âœ… Deployment guide\n\n### CI/CD\n- âœ… Updated GitHub Actions workflow\n- âœ… Automated linting, building, and testing\n\n## ğŸƒ How to Run Locally\n\nSee the comprehensive [backend-v2/README.md](backend-v2/README.md) for detailed setup instructions.\n\n**Quick Start**:\n```bash\ncd backend-v2\nnpm install\ncp .env.example .env\n# Edit .env with your database credentials\nnpm run prisma:generate\nnpm run prisma:migrate\nnpm run prisma:seed\nnpm run dev\n```\n\nTest credentials: `owner@seed.local` / `ChangeMe123!`\n\n## ğŸš€ Production Deployment\n\n1. Set production environment variables\n2. Run `npm ci --only=production`\n3. Run `npx prisma generate`\n4. Run `npx prisma migrate deploy`\n5. Run `npm run build`\n6. Run `npm run start:prod`\n\nSee README for Docker deployment option.\n\n## ğŸ“Š API Endpoints\n\n### Authentication\n- `POST /auth/login` - Login\n- `POST /auth/refresh` - Refresh token\n- `GET /auth/me` - Current user\n- `POST /auth/logout` - Logout\n\n### Protected Endpoints\n- Organisations, Users, Employees, Locations, Shifts, Availability\n- All require Bearer token authentication\n- Role-based access control enforced\n\n## ğŸ” Security\n\n- JWT with access + refresh tokens\n- bcrypt password hashing\n- Role-based authorization\n- Environment variable validation\n- Multi-tenant data isolation\n\n## ğŸ§ª Testing & Quality\n\n- âœ… All tests passing (3 suites, 6 tests)\n- âœ… Build successful\n- âœ… ESLint passing\n- âœ… TypeScript strict mode\n\n## ğŸ“ Important Notes\n\n- **Legacy backend untouched**: `/backend` remains operational\n- **No breaking changes**: Both backends can run simultaneously\n- **Generated files excluded**: Prisma client not committed\n- **Production-ready**: Can be deployed immediately\n\n## âœ… Checklist\n\n- [x] NestJS application structure\n- [x] Prisma schema and migrations\n- [x] Authentication & Authorization\n- [x] All core modules\n- [x] DTOs with validation\n- [x] Error handling\n- [x] Unit tests\n- [x] Documentation\n- [x] CI/CD\n- [x] Build successful\n- [x] Tests passing\n\n---\n\n**Ready to merge**: Production-ready and can be deployed alongside legacy backend.",
  "head": "agent/you-are-an-ai-coding-agent-working-on-the-private-0609",
  "base": "main"
}
